(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (def
            :edges
            ([a::INT b::INT]
             (or
               (and (= a 1) (= b 2))
               (and (= a 2) (= b 3))
               (and (= a 3) (= b 4))
               (and (= a 2) (= b 5))
               (and (= a 5) (= b 3))
               (and (= a 6) (= b 5)))))
          (algorithm
            :reachable
            (script
              (loop
                (init (assign :reachable ([n::INT] (= n 1))))
                (script
                  (assign
                    :next
                    ([m::INT]
                     (or
                       (atom :reachable m)
                       (exists [n::INT] (and (atom :reachable n) (atom :edges n m))))))
                  (break
                    :nothing_new
                    ([]
                     (ffi
                       :rel_primitive_pairwise_equal
                       (args ([n::INT] (atom :reachable n)) ([n::INT] (atom :next n)))
                       (terms))))
                  (assign :reachable ([n::INT] (atom :next n)))))))
          (algorithm
            :frontier
            :reachable_2
            (script
              (loop
                (init
                  (assign :frontier ([n::INT] (= n 1)))
                  (assign :reachable_2 ([_n::INT] (false))))
                (script
                  (upsert :reachable_2 ([n::INT] (atom :frontier n)))
                  (assign
                    :next
                    ([m::INT]
                     (exists
                       [n::INT]
                       (and
                         (and (atom :frontier n) (atom :edges n m))
                         (not (atom :reachable_2 m))))))
                  (assign :frontier ([n::INT] (atom :next n)))
                  (break
                    :empty_frontier
                    ([]
                     (ffi
                       :rel_primitive_all_empty
                       (args ([n::INT] (atom :frontier n)))
                       (terms)))))))))))
    (reads (output :reachable :reachable) (output :reachable_2 :reachable_2))))

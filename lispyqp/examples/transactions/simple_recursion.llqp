(transaction
    (epoch
        (local_writes
            (define
                (fragment :f1
                    (def :edge1 ([x::STRING y::STRING] (and (= x::STRING "a") (= y::STRING "b"))))
                    (def :edge2 ([x::STRING y::STRING] (and (= x::STRING "b") (= y::STRING "c"))))
                    (def :edge3 ([x::STRING y::STRING] (and (= x::STRING "b") (= y::STRING "d"))))
                    (def :edge4 ([x::STRING y::STRING] (and (= x::STRING "d") (= y::STRING "e"))))

                    (def :edge
                        ([x::STRING y::STRING]
                            (or
                                (atom :edge1 x::STRING y::STRING)
                                (atom :edge2 x::STRING y::STRING)
                                (atom :edge3 x::STRING y::STRING)
                                (atom :edge4 x::STRING y::STRING))))

                    (def :path1
                        ([x::STRING y::STRING] (atom :edge x::STRING y::STRING)))

                    (def :path2
                        ([x::STRING z::STRING]
                            (exists [y::STRING]
                                (and
                                    (atom :edge x::STRING y::STRING)
                                    (atom :path y::STRING z::STRING)))))

                    (def :path
                        ([x::STRING y::STRING]
                            (or
                                (atom :path1 x::STRING y::STRING)
                                (atom :path2 x::STRING y::STRING))))

                    (def :output
                        ([x::STRING y::STRING] (atom :path x::STRING y::STRING))))))

        (reads
            (output :result :output))))

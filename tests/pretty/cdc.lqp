(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (csv_data
            (csv_locator (paths "s3://bucket/cdc/batch_001.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "raw_data" [])
              (column ["append" "METADATA$KEY"] :mk_ins [UINT128])
              (column ["delete" "METADATA$KEY"] :mk_del [UINT128])
              (column ["append" "user_id"] :uid_ins [INT])
              (column ["append" "name"] :name_ins [STRING])
              (column "id" :entity_id [INT])
              (column ["append" "id"] :eid_ins [INT])
              (column ["delete" "id"] :eid_del [INT]))
            (asof "2025-06-01T00:00:00Z")))))
    (reads
      (output :mk_ins :mk_ins)
      (output :mk_del :mk_del)
      (output :uid_ins :uid_ins)
      (output :name_ins :name_ins)
      (output :entity_id :entity_id)
      (output :eid_ins :eid_ins)
      (output :eid_del :eid_del))))

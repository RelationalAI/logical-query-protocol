(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (csv_data
            (csv_locator (paths "s3://bucket/cdc/batch_001.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "raw_data" [])
              (column ["append" "METADATA$KEY"] 0xb7219c9b1f7d843d [UINT128])
              (column ["delete" "METADATA$KEY"] 0xc45b4cf618eed32f [UINT128])
              (column ["append" "user_id"] 0x7982cff88800e869 [INT])
              (column ["append" "name"] 0x8cb6c4889f2f67c7 [STRING])
              (column "id" 0x5364bf081a053f95 [INT])
              (column ["append" "id"] 0x22d32663113e8a7d [INT])
              (column ["delete" "id"] 0x337b9038b6bf2f6a [INT]))
            (asof "2025-06-01T00:00:00Z")))))
    (reads
      (output :mk_ins 0xb7219c9b1f7d843d)
      (output :mk_del 0xc45b4cf618eed32f)
      (output :uid_ins 0x7982cff88800e869)
      (output :name_ins 0x8cb6c4889f2f67c7)
      (output :entity_id 0x5364bf081a053f95)
      (output :eid_ins 0x22d32663113e8a7d)
      (output :eid_del 0x337b9038b6bf2f6a))))

;; Debug information
;; -----------------------
;; Original names
;; 	 ID `0x337b9038b6bf2f6a` -> `eid_del`
;; 	 ID `0x22d32663113e8a7d` -> `eid_ins`
;; 	 ID `0x5364bf081a053f95` -> `entity_id`
;; 	 ID `0xc45b4cf618eed32f` -> `mk_del`
;; 	 ID `0xb7219c9b1f7d843d` -> `mk_ins`
;; 	 ID `0x8cb6c4889f2f67c7` -> `name_ins`
;; 	 ID `0x7982cff88800e869` -> `uid_ins`

(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (csv_data
            (csv_locator (paths "s3://bucket/cdc/batch_001.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "raw_data" [])
              (column
                ["append" "METADATA$KEY"]
                0x8dfeb4bd8f6d8c353d847d1f9b9c21b7
                [UINT128])
              (column
                ["delete" "METADATA$KEY"]
                0xa91fbfb76393ae562fd3ee18f64c5bc4
                [UINT128])
              (column ["append" "user_id"] 0xf68f290595d54fb669e80088f8cf8279 [INT])
              (column ["append" "name"] 0x2756fdf898b5a25ac7672f9f88c4b68c [STRING])
              (column "id" 0xc0c8b0135d8dee07953f051a08bf6453 [INT])
              (column ["append" "id"] 0xd21b8166f6243157d8a3e116326d322 [INT])
              (column ["delete" "id"] 0xe870ce327bf8f16e6a2fbfb638907b33 [INT]))
            (asof "2025-06-01T00:00:00Z")))))
    (reads
      (output :mk_ins 0x8dfeb4bd8f6d8c353d847d1f9b9c21b7)
      (output :mk_del 0xa91fbfb76393ae562fd3ee18f64c5bc4)
      (output :uid_ins 0xf68f290595d54fb669e80088f8cf8279)
      (output :name_ins 0x2756fdf898b5a25ac7672f9f88c4b68c)
      (output :entity_id 0xc0c8b0135d8dee07953f051a08bf6453)
      (output :eid_ins 0xd21b8166f6243157d8a3e116326d322)
      (output :eid_del 0xe870ce327bf8f16e6a2fbfb638907b33))))

;; Debug information
;; -----------------------
;; Original names
;; 	 ID `0xe870ce327bf8f16e6a2fbfb638907b33` -> `eid_del`
;; 	 ID `0xd21b8166f6243157d8a3e116326d322` -> `eid_ins`
;; 	 ID `0xc0c8b0135d8dee07953f051a08bf6453` -> `entity_id`
;; 	 ID `0xa91fbfb76393ae562fd3ee18f64c5bc4` -> `mk_del`
;; 	 ID `0x8dfeb4bd8f6d8c353d847d1f9b9c21b7` -> `mk_ins`
;; 	 ID `0x2756fdf898b5a25ac7672f9f88c4b68c` -> `name_ins`
;; 	 ID `0xf68f290595d54fb669e80088f8cf8279` -> `uid_ins`

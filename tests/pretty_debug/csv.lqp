(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (csv_data
            (csv_locator (paths "s3://bucket/data/file1.csv" "s3://bucket/data/file2.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "user_id" 0x86add8d0b4095bbc41324560696b9df8 [INT])
              (column "name" 0x9de061fc7fe51777d3c49ed4000e0d2e [STRING])
              (column "score" 0x769fe23880de6895dbac5b891d9280d0 [FLOAT]))
            (asof "2025-01-01T00:00:00Z"))
          (csv_data
            (csv_locator (paths "https://example.com/data.csv"))
            (csv_config
              {
               :csv_comment "#"
               :csv_compression "gzip"
               :csv_decimal_separator ","
               :csv_delimiter "|"
               :csv_encoding "latin-1"
               :csv_escapechar "\\"
               :csv_header_row 2
               :csv_missing_strings "NA"
               :csv_quotechar "'"
               :csv_skip 1})
            (columns
              (column "timestamp" 0x81f76e18d5e6dd6fdbf6f00af663ad44 [DATETIME])
              (column "value" 0x6b6a5af7a3bd06c6603f28745fc6df97 [(DECIMAL 18 4)]))
            (asof "2025-01-15T12:00:00Z"))
          (csv_data
            (csv_locator (inline_data "user_id,name,score\n1,Alice,95.5\n2,Bob,87.3"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "user_id" 0xa04a053d9711b3e2f104b1177f20218 [INT])
              (column "name" 0xf590a4fddf3eddd683b072e43581ce26 [STRING])
              (column "score" 0xd5b7d4ca6dd34a9e0603057117ccbc1f [FLOAT]))
            (asof "2025-01-01T00:00:00Z"))
          (csv_data
            (csv_locator (paths "/local/path/data.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter "\t"
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "id" 0xa94b49b01f92b357e9493735d5ec9cbd [INT STRING])
              (column "data" 0xef5254539f081c7b5e967f5448b55004 [STRING FLOAT BOOLEAN]))
            (asof "2025-02-01T00:00:00Z"))
          (csv_data
            (csv_locator (paths "data/infer.csv"))
            (csv_config
              {
               :csv_compression "auto"
               :csv_decimal_separator "."
               :csv_delimiter ","
               :csv_encoding "utf-8"
               :csv_escapechar "\""
               :csv_header_row 1
               :csv_quotechar "\""
               :csv_skip 0})
            (columns
              (column "col1" 0x8fa946240763735f7d6fa808cebaccd7 [])
              (column "col2" 0x4f3abefa7fed25acd27211b61383fd59 []))
            (asof "2025-03-01T00:00:00Z")))))
    (reads
      (output :user_id 0x86add8d0b4095bbc41324560696b9df8)
      (output :user_name 0x9de061fc7fe51777d3c49ed4000e0d2e)
      (output :user_score 0x769fe23880de6895dbac5b891d9280d0)
      (output :ts 0x81f76e18d5e6dd6fdbf6f00af663ad44)
      (output :val 0x6b6a5af7a3bd06c6603f28745fc6df97)
      (output :inline_user_id 0xa04a053d9711b3e2f104b1177f20218)
      (output :inline_user_name 0xf590a4fddf3eddd683b072e43581ce26)
      (output :inline_user_score 0xd5b7d4ca6dd34a9e0603057117ccbc1f)
      (output :multi_id 0xa94b49b01f92b357e9493735d5ec9cbd)
      (output :multi_data 0xef5254539f081c7b5e967f5448b55004)
      (output :inferred1 0x8fa946240763735f7d6fa808cebaccd7)
      (output :inferred2 0x4f3abefa7fed25acd27211b61383fd59))))

;; Debug information
;; -----------------------
;; Original names
;; 	 ID `0x8fa946240763735f7d6fa808cebaccd7` -> `inferred1`
;; 	 ID `0x4f3abefa7fed25acd27211b61383fd59` -> `inferred2`
;; 	 ID `0xa04a053d9711b3e2f104b1177f20218` -> `inline_user_id`
;; 	 ID `0xf590a4fddf3eddd683b072e43581ce26` -> `inline_user_name`
;; 	 ID `0xd5b7d4ca6dd34a9e0603057117ccbc1f` -> `inline_user_score`
;; 	 ID `0xef5254539f081c7b5e967f5448b55004` -> `multi_data`
;; 	 ID `0xa94b49b01f92b357e9493735d5ec9cbd` -> `multi_id`
;; 	 ID `0x81f76e18d5e6dd6fdbf6f00af663ad44` -> `ts`
;; 	 ID `0x86add8d0b4095bbc41324560696b9df8` -> `user_id`
;; 	 ID `0x9de061fc7fe51777d3c49ed4000e0d2e` -> `user_name`
;; 	 ID `0x769fe23880de6895dbac5b891d9280d0` -> `user_score`
;; 	 ID `0x6b6a5af7a3bd06c6603f28745fc6df97` -> `val`

(transaction
  (configure { :ivm.maintenance_level "off" :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment
          :f1
          (def
            0x3441301d3c459bf98fc6ff686bb4262c
            ([category::STRING amount::FLOAT]
             (or
               (and (= category "food") (= amount 1.23))
               (and (= category "food") (= amount 10.23))
               (and (= category "food") (= amount 13.0))
               (and (= category "drink") (= amount 6.34))
               (and (= category "drink") (= amount 2.82)))))
          (def
            0x1b6ee5d0984a5c2653983028effff509
            ([cat::STRING x::FLOAT]
             (reduce
               ([a::FLOAT b::FLOAT c::FLOAT] (+ a b c))
               ([num::FLOAT] (atom 0x3441301d3c459bf98fc6ff686bb4262c cat num))
               (terms x))))
          (def
            0x64f93ae2395c81c92978932b3a49356c
            ([cat::STRING x::INT]
             (reduce
               ([a::FLOAT b::FLOAT c::FLOAT] (+ a b c))
               ([num::FLOAT one::INT]
                (and (atom 0x3441301d3c459bf98fc6ff686bb4262c cat num) (= one 1)))
               (terms x)))))))
    (reads
      (output :items_sum 0x1b6ee5d0984a5c2653983028effff509)
      (output :items_count 0x64f93ae2395c81c92978932b3a49356c))))

;; Debug information
;; -----------------------
;; Original names
;; 	 ID `0x64f93ae2395c81c92978932b3a49356c` -> `count`
;; 	 ID `0x3441301d3c459bf98fc6ff686bb4262c` -> `foo`
;; 	 ID `0x1b6ee5d0984a5c2653983028effff509` -> `sum`

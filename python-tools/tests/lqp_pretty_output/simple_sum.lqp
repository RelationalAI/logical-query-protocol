(transaction
  (configure
    { :ivm.maintenance_level "off"
      :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment :f1
          (def :foo
            ([x::INT]
              (or
                (primitive :rel_primitive_eq x 1)
                (primitive :rel_primitive_eq x 2)
                (primitive :rel_primitive_eq x 3))))
          (def :bar
            ([x::INT]
              (atom :foo x)))
          (def :result
            ([x::INT]
              (reduce
                ([a::INT b::INT c::INT]
                  (primitive :rel_primitive_add_monotype a b c))
                ([num::INT]
                  (atom :bar num))
                (terms x)))))))
    (reads
      (output :foo :result))))

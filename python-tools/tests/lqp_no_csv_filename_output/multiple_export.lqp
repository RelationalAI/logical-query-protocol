(transaction
  (configure
    { :ivm.maintenance_level "off"
      :semantics_version 0})
  (epoch
    (writes
      (define
        (fragment :f1
          (def :cola1
            ([row::INT v::INT]
              (and
                (primitive :rel_primitive_eq row 1)
                (primitive :rel_primitive_eq 2 v))))
          (def :cola2
            ([row::INT v::STRING]
              (and
                (primitive :rel_primitive_eq row 1)
                (primitive :rel_primitive_eq v "hello"))))
          (def :colb1
            ([row_1::STRING row_2::(DECIMAL 18 6) row_3::UINT128 row_4::FLOAT v::FLOAT]
              (and
                (primitive :rel_primitive_eq row_1 "b")
                (primitive :rel_primitive_parse_decimal #64 #6 "12.12" row_2)
                (primitive :rel_primitive_eq row_3 0x123abc)
                (primitive :rel_primitive_eq row_4 1.234)
                (primitive :rel_primitive_eq v 6.1))))
          (def :colb2
            ([row_1::STRING row_2::(DECIMAL 18 6) row_3::UINT128 row_4::FLOAT v::INT]
              (and
                (primitive :rel_primitive_eq row_1 "b")
                (primitive :rel_primitive_parse_decimal #64 #6 "12.12" row_2)
                (primitive :rel_primitive_eq row_3 0x123abc)
                (primitive :rel_primitive_eq row_4 1.234)
                (primitive :rel_primitive_eq v 123)))))))
    (reads
      (export
        (export_csv_config
          (path "<hidden filename>")
          (columns (column "col1name" :cola1) (column "col2name" :cola2))
          { :compression ""
            :partition_size 10
            :syntax_delim ","
            :syntax_escapechar "\\"
            :syntax_header_row 1
            :syntax_missing_string ""
            :syntax_quotechar "\""}))
      (export
        (export_csv_config
          (path "<hidden filename>")
          (columns (column "blahblah" :colb1) (column "foofoo" :colb2))
          { :compression ""
            :partition_size 0
            :syntax_delim ","
            :syntax_escapechar "\\"
            :syntax_header_row 1
            :syntax_missing_string ""
            :syntax_quotechar "\""})))))

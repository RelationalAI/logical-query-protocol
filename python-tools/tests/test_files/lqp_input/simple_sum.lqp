(transaction
    (epoch
        (local_writes
            (define
                (fragment :f1
                    (def :foo ([x::INT] (or (= x 1) (= x 2) (= x 3))))
                    (def :bar ([x::INT] (atom :foo x)))
                    (def :result
                        ([x::INT]
                            (reduce
                                ([a::INT b::INT c::INT] (+ a b c))   ;; op
                                ([num::INT] (atom :bar num))                   ;; body
                                (terms x)))))))

        (reads
            (output :foo :result))))

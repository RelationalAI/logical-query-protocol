(transaction
  (epoch
    (local_writes
      (define
        (fragment :f1
          (def :common
            ([_lineitem::UINT128 _lineitem_l_returnflag::STRING _lineitem_l_linestatus::STRING]
              (exists [_lineitem_l_shipdate::DATE _date_limit::DATE]
                (and
                  (relatom :LineItem _lineitem::UINT128)
                  (relatom :l_shipdate _lineitem::UINT128 _lineitem_l_shipdate::DATE)
                  (relatom :l_returnflag _lineitem::UINT128 _lineitem_l_returnflag::STRING)
                  (relatom :l_linestatus _lineitem::UINT128 _lineitem_l_linestatus::STRING)

                  ;; We don't have date literals in LQP, so we need to get the date limit
                  ;; from a relatom
                  (relatom :date_limit _date_limit::DATE)
                  (<= _lineitem_l_shipdate::DATE _date_limit::DATE))))))))))

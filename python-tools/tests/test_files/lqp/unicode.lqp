;; Test UTF-8 encoded content with international characters
(transaction
  (epoch
    (writes
      (define
        (fragment :f1
          (csv_data
            (csv_locator
              (inline_data "id,name,city,greeting\n1,François,Paris,Bonjour\n2,田中,東京,こんにちは\n3,Müller,München,Grüß Gott\n4,Иван,Москва,Привет"))
            (csv_config
              {:csv_header_row 1
               :csv_delimiter ","
               :csv_quotechar "\""
               :csv_escapechar "\\"
               :csv_encoding "utf-8"})
            (columns
              (column "id" :id [INT INT])
              (column "name" :name [INT STRING])
              (column "city" :city [INT STRING])
              (column "greeting" :greeting [INT STRING]))
            (asof "2025-01-01T00:00:00Z"))

          (def :unicode_data
            ([id::INT name::STRING city::STRING greeting::STRING]
             (exists [row::INT]
               (and
                 (atom :id row id)
                 (atom :name row name)
                 (atom :city row city)
                 (atom :greeting row greeting))))))))
    (reads
      (output :unicode_data :unicode_data))))
